<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
    <link rel="stylesheet" href="../style/styles3.css">
    <script src="../utils/api-functions.js"></script>
    <title>Graxa - Awwwards Style</title>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <a href="#" class="logo-link">GRAXA</a>
            </div>
            <nav class="nav">
                <a href="#" class="nav-link" onclick="openModal('aeroporto')">Aeroporto</a>
                <a href="#" class="nav-link" onclick="openModal('restaurante')">Restaurante</a>
                <a href="#" class="nav-link" onclick="openModal('mapa')">Mapa</a>
            </nav>
            <div class="user-dropdown" id="userDropdown">
                <div id="btn-dropdown">
                    <span class="user-name" id="headerName"></span><i class="fas fa-chevron-down"></i>
                </div>
                <div class="dropdown-content" id="dropdownContent">
                    <button id="btn-logout" onclick="logout()">Sair</button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="profile-container">
                <!-- <div class="profile-header">
                    <h1 class="profile-title">Seja bem Vindo! <span id="nomeUsuarioTitle"></span></h1>
                    <button id="btn-buscar-aeroporto" class="btn-primary">Aeroporto mais próximo</button>
                </div> -->

                <div class="profile-card">
                    <div class="card-header">
                        <h2 class="card-title">Seus Dados</h2>
                        <div class="card-actions">
                            <a id="btn-desativar" class="action-icon"><i class="fas fa-trash fa-lg"></i></a>
                            <a onclick="editarUsuario()" class="action-icon"><i class="fas fa-edit fa-lg"></i></a>
                        </div>
                    </div>
                    <form id="form-container-usuario" class="profile-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="input_nome" class="form-label">Nome</label>
                                <input type="text" id="input_nome" class="form-input">
                            </div>
                            <div class="form-group">
                                <label for="input_tipoUsuario" class="form-label">Tipo de Usuário</label>
                                <input type="text" id="input_tipoUsuario" class="form-input" disabled>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="input_email" class="form-label">Email</label>
                            <input type="email" id="input_email" class="form-input" disabled>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="input_cpf" class="form-label">CPF</label>
                                <input type="text" id="input_cpf" class="form-input" disabled>
                            </div>
                            <div class="form-group">
                                <label for="input_telefone" class="form-label">Telefone</label>
                                <input type="text" id="input_telefone" class="form-input" disabled>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn-primary" id="btn-atualizar" style="display: none;">Atualizar</button>
                        </div>
                    </form>
                </div>
                <div id="message-container"></div>
            </div>
        </main>
    </div>

    <div id="modal-desativar" class="modal-overlay">
        <div class="modal-box">
            <h2>Desativar Conta</h2>
            <p>Você tem certeza que deseja desativar sua conta?</p>
            <div class="modal-actions">
                <button id="cancelar-desativar" class="btn-cancelar">Cancelar</button>
                <button id="confirmar-desativar" class="btn-confirmar">Desativar</button>
            </div>
        </div>
    </div>

    <div id="modal-aeroporto" class="modal-overlay">
        <div class="modal-box">
            <h2>Aeroporto mais próximo</h2>
            <div id="aeroporto-info"></div>
            <div class="modal-actions">
                <button id="fechar-modal-aeroporto" class="btn-cancelar">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal Dinâmico Principal -->
    <div id="modal-dinamico" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-header">
                <h2 id="modal-title">Buscar</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-content">
                <!-- Formulário de busca -->
                <form id="search-form" class="search-form">
                    <div id="form-fields">
                        <!-- Campos serão inseridos dinamicamente -->
                    </div>
                    <button type="submit" class="btn-primary" id="search-btn">Buscar</button>
                </form>
                
                <!-- Área de resultados -->
                <div id="results-container" class="results-container" style="display: none;">
                    <h3>Resultados:</h3>
                    <div id="results-content"></div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>
<script>
    // Variável global para controlar o tipo de busca atual
    let currentSearchType = '';

    // Função para abrir o modal dinâmico
    function openModal(type) {
        currentSearchType = type;
        const modal = document.getElementById('modal-dinamico');
        const title = document.getElementById('modal-title');
        const formFields = document.getElementById('form-fields');
        const resultsContainer = document.getElementById('results-container');
        
        // Limpar resultados anteriores
        resultsContainer.style.display = 'none';
        document.getElementById('results-content').innerHTML = '';
        
        // Configurar título e campos baseado no tipo
        switch(type) {
            case 'aeroporto':
                title.textContent = 'Buscar Aeroporto';
                formFields.innerHTML = `
                    <div class="form-group">
                        <label for="endereco" class="form-label">Endereço</label>
                        <input type="text" id="endereco" class="form-input" placeholder="Digite seu endereço" required>
                    </div>
                `;
                break;
            case 'restaurante':
                title.textContent = 'Buscar Restaurantes';
                formFields.innerHTML = `
                    <div class="form-group">
                        <label for="endereco" class="form-label">Endereço</label>
                        <input type="text" id="endereco" class="form-input" placeholder="Digite seu endereço" required>
                    </div>
                `;
                break;
            case 'mapa':
                title.textContent = 'Buscar Rota';
                formFields.innerHTML = `
                    <div class="form-group">
                        <label for="endereco-origem" class="form-label">Endereço de Origem</label>
                        <input type="text" id="endereco-origem" class="form-input" placeholder="Digite o endereço de origem" required>
                    </div>
                    <div class="form-group">
                        <label for="endereco-destino" class="form-label">Endereço de Destino</label>
                        <input type="text" id="endereco-destino" class="form-input" placeholder="Digite o endereço de destino" required>
                    </div>
                `;
                break;
        }
        
        // Mostrar modal
        modal.style.display = 'flex';
        modal.classList.add('active');
    }

    // Função para fechar o modal
    function closeModal() {
        const modal = document.getElementById('modal-dinamico');
        modal.style.display = 'none';
        modal.classList.remove('active');
        currentSearchType = '';
    }

    // Função para realizar a busca
    async function performSearch(event) {
        event.preventDefault();
        
        const searchBtn = document.getElementById('search-btn');
        const resultsContainer = document.getElementById('results-container');
        const resultsContent = document.getElementById('results-content');
        
        // Mostrar loading
        searchBtn.textContent = 'Buscando...';
        searchBtn.disabled = true;
        
        try {
            let results = '';
            
            switch(currentSearchType) {
                case 'aeroporto':
                    const endereco = document.getElementById('endereco').value;
                    results = await buscarAeroporto(endereco);
                    break;
                case 'restaurante':
                    const enderecoRest = document.getElementById('endereco').value;
                    results = await buscarRestaurantes(enderecoRest);
                    break;
                case 'mapa':
                    const origem = document.getElementById('endereco-origem').value;
                    const destino = document.getElementById('endereco-destino').value;
                    results = await buscarRota(origem, destino);
                    break;
            }
            
            // Mostrar resultados
            resultsContent.innerHTML = results;
            resultsContainer.style.display = 'block';
            
        } catch (error) {
            resultsContent.innerHTML = '<p class="error">Erro ao realizar a busca. Tente novamente.</p>';
            resultsContainer.style.display = 'block';
        } finally {
            // Restaurar botão
            searchBtn.textContent = 'Buscar';
            searchBtn.disabled = false;
        }
    }

    // Funções de busca usando APIs reais
    async function buscarAeroporto(endereco) {
        return await buscarAeroportoReal(endereco);
    }

    async function buscarRestaurantes(endereco) {
        return await buscarRestaurantesReal(endereco);
    }

    async function buscarRota(origem, destino) {
        return await buscarRotaReal(origem, destino);
    }

    // Event listener para o formulário
    document.addEventListener('DOMContentLoaded', function() {
        const searchForm = document.getElementById('search-form');
        if (searchForm) {
            searchForm.addEventListener('submit', performSearch);
        }
    });
</script>
<script type="module" src="../pages/usuarios.js"></script>

<script type="module">
    import { getIdUsuarios } from "../pages/usuarios.js";
    getIdUsuarios();
</script>
<script>
    function editarUsuario() {
        const inputs = document.querySelectorAll("#form-container-usuario input")
        if (inputs[0].disabled == false) {
            inputs.forEach(input => {
                input.disabled = true;
            });
            document.getElementById("btn-atualizar").style.display = "none"
            return
        }
        inputs.forEach(input => {
            input.disabled = false;
        });

        document.getElementById("btn-atualizar").style.display = "block"
    }
</script>
<script src="https://unpkg.com/imask"></script>
<script type="module">
    import { capitalizar } from "../utils/stringUtils.js";
    var cpfElement = document.getElementById("input_cpf");
    var telefoneElement = document.getElementById("input_telefone");
    var nomeElement = document.getElementById("input_nome");
    var cpfMask = IMask(cpfElement, {
        mask: "000.000.000-00"
    });

    var telefoneMask = IMask(telefoneElement, {
        mask: "(00) 00000-0000"
    });

    nomeElement.addEventListener("blur", () => {
        nomeElement.value = capitalizar(nomeElement.value);

    });
</script>
<script>

    if (document.querySelector("#btn-dropdown")) {
        document.querySelector("#btn-dropdown").addEventListener("click", abrirDropDown);
    }
    function abrirDropDown() {
        const dropdown = document.querySelector(".dropdown-content");
        const displayAtual = window.getComputedStyle(dropdown).display;

        if (displayAtual === "none") {
            dropdown.style.display = "flex";
        } else {
            dropdown.style.display = "none";
        }
    }

    function logout(){
        sessionStorage.clear()
        window.location.href = 
'/login';
    }

</script>

<script>
    const modal = document.getElementById("modal-desativar");
const btnDesativar = document.getElementById("btn-desativar");
const btnCancelar = document.getElementById("cancelar-desativar");
const btnConfirmar = document.getElementById("confirmar-desativar");

btnDesativar.addEventListener("click", () => {
  modal.style.display = "flex";
});

btnCancelar.addEventListener("click", () => {
  modal.style.display = "none";
});

btnConfirmar.addEventListener("click", async () => {
    
  modal.style.display = "none";
});

</script>

